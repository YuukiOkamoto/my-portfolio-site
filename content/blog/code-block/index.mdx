---
title: ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã§å®Ÿè£…ã—ã¦ã„ã‚‹æ©Ÿèƒ½ç´¹ä»‹ï¼
date: '2020-06-02T11:30:00Z'
description: ''
featured: false
cover: ./cover.jpeg
tags:
  - Gatsby
---

import Callout from '../../../src/components/widgetComponents/Callout';
import CodeBlock from '../../../src/components/MDXComponents/CodeBlock';
import Collapse from '../../../src/components/widgetComponents/Collapse';
import ExternalLink from '../../../src/components/widgetComponents/ExternalLink';

å½“ãƒ–ãƒ­ã‚°ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã§å®Ÿè£…ã—ã¦ã„ã‚‹æ©Ÿèƒ½ã€ãã®ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã™ï¼

## æ©Ÿèƒ½ç´¹ä»‹

### ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ

`.mdx`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã‚“ãªæ„Ÿã˜ã«æ›¸ãã¨ã€

<CodeBlock>
  {`
\`\`\`js  
const trainingMenu = new Set('Squat');  
\`\`\`
`}
</CodeBlock>

ã“ã†ã‚„ã£ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼

```js
const trainingMenu = new Set('Squat');
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  è¨€èªã‚’æŒ‡å®šã™ã‚‹ã¨è¨€èªã«åˆã‚ã›ãŸè‰²ãŒä»˜ã„ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼
</Callout>

### ã‚¿ã‚¤ãƒˆãƒ«

`.mdx`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã‚“ãªæ„Ÿã˜ã«æ›¸ãã¨ã€

<CodeBlock>
  {`
\`\`\`js title=trainingMenu.js  
const trainingMenu = new Set('Squat');  
trainingMenu.add('Bulgarian squat');  
\`\`\`
`}
</CodeBlock>

ã“ã†ã‚„ã£ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼

```js title=trainingMenu.js
const trainingMenu = new Set('Squat');
trainingMenu.add('Bulgarian squat');
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  ã‚¿ã‚¤ãƒˆãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼
</Callout>

### ã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ”ãƒ¼

å³ä¸Šã®ã‚³ãƒ”ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„ï¼

```js title=trainingMenu.js
const trainingMenu = new Set('Squat');
trainingMenu.add('Bulgarian squat');
trainingMenu.add('Calf raises');
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  ã‚³ãƒ¼ãƒ‰ãŒã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã™ï¼(^âˆ€^)á•—
</Callout>

### è¡Œã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ

`.mdx`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã‚“ãªæ„Ÿã˜ã«æ›¸ãã¨ã€

<CodeBlock>
  {`
\`\`\`js title=trainingMenu.js line={1,3-4}  
const trainingMenu = new Set('Squat');  
trainingMenu.add('Bulgarian squat');  
trainingMenu.add('Calf raises');  
trainingMenu.add('Bench press');  
\`\`\`
`}
</CodeBlock>

ã“ã†ã‚„ã£ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼

```js title=trainingMenu.js line={1,3-4}
const trainingMenu = new Set('Squat');
trainingMenu.add('Bulgarian squat');
trainingMenu.add('Calf raises');
trainingMenu.add('Bench press');
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  è¡Œã‚’æŒ‡å®šã—ã¦ãƒã‚¤ãƒ©ã‚¤ãƒˆãŒã§ãã¾ã—ãŸï¼
</Callout>

### ãƒ¯ãƒ¼ãƒ‰ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ

ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å†…ã®ãƒ¯ãƒ¼ãƒ‰ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’åˆã‚ã›ã¦ã¿ã¦ãã ã•ã„ï¼

```js title=trainingMenu.js line={1,3-4}
const trainingMenu = new Set('Squat');
trainingMenu.add('Bulgarian squat');
trainingMenu.add('Calf raises');
trainingMenu.add('Bench press');
trainingMenu.add('Chinning');
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  åŒã˜ãƒ¯ãƒ¼ãƒ‰ãŒãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã¾ã™ï¼Qiitaã¿ãŸã„ï¼ï¼
</Callout>

![Word highlight](./word-highlight.gif)

### JSX ã®ãƒ‡ãƒ¢è¡¨ç¤º

`.mdx`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã‚“ãªæ„Ÿã˜ã«æ›¸ãã¨ã€

<CodeBlock>
{`
\`\`\`jsx demo title=æ³•ãŒäººã‚’å®ˆã‚‹ã‚“ã˜ã‚ƒãªã„ã€äººãŒæ³•ã‚’å®ˆã‚‹ã‚“ã§ã™  
<Stack spacing='3'>  
  <Alert status='success'>
    <AlertIcon />
    çŠ¯ç½ªä¿‚æ•°ã‚¢ãƒ³ãƒ€ãƒ¼60ã€‚<br/>åŸ·è¡Œå¯¾è±¡ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br/>ãƒˆãƒªã‚¬ãƒ¼ã‚’ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚
  </Alert>

  <Alert status='info'>
    <AlertIcon />
    çŠ¯ç½ªä¿‚æ•°ã‚ªãƒ¼ãƒãƒ¼130ã€‚<br/>åŸ·è¡Œãƒ¢ãƒ¼ãƒ‰ï¼šãƒãƒ³ãƒªãƒ¼ã‚µãƒ«ãƒ»ãƒ‘ãƒ©ãƒ©ã‚¤ã‚¶ãƒ¼ã€‚<br/>æ…é‡ã«ç…§æº–ã‚’å®šã‚ å¯¾è±¡ã‚’åˆ¶åœ§ã—ã¦ä¸‹ã•ã„ã€‚  
  </Alert>  
  
  <Alert status='warning'>  
    <AlertIcon />  
    çŠ¯ç½ªä¿‚æ•°ã‚ªãƒ¼ãƒãƒ¼390ã€‚<br/>åŸ·è¡Œãƒ¢ãƒ¼ãƒ‰ï¼šãƒªãƒ¼ã‚µãƒ«ãƒ»ã‚¨ãƒªãƒŸãƒãƒ¼ã‚¿ãƒ¼ã€‚<br/>æ…é‡ã«ç…§æº–ã‚’å®šã‚ã€å¯¾è±¡ã‚’æ’é™¤ã—ã¦ãã ã•ã„ã€‚  
  </Alert>  
  
  <Alert status='error'>  
    <AlertIcon />  
    å¯¾è±¡ã®é©šç•°åˆ¤å®šãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚<br/>åŸ·è¡Œãƒ¢ãƒ¼ãƒ‰ï¼šãƒ‡ã‚¹ãƒˆãƒ­ã‚¤ãƒ»ãƒ‡ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ¼ã€‚<br/>å¯¾è±¡ã‚’å®Œå…¨æ’é™¤ã—ã¾ã™ã€‚ã”æ³¨æ„ä¸‹ã•ã„ã€‚  
  </Alert>  
</Stack>  
\`\`\`
`}
</CodeBlock>

ã“ã†ã‚„ã£ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼

```jsx demo title=æ³•ãŒäººã‚’å®ˆã‚‹ã‚“ã˜ã‚ƒãªã„ã€äººãŒæ³•ã‚’å®ˆã‚‹ã‚“ã§ã™
<Stack spacing='3'>
  <Alert status='success'>
    <AlertIcon />
    çŠ¯ç½ªä¿‚æ•°ã‚¢ãƒ³ãƒ€ãƒ¼60ã€‚
    <br />
    åŸ·è¡Œå¯¾è±¡ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
    <br />
    ãƒˆãƒªã‚¬ãƒ¼ã‚’ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚
  </Alert>

  <Alert status='info'>
    <AlertIcon />
    çŠ¯ç½ªä¿‚æ•°ã‚ªãƒ¼ãƒãƒ¼130ã€‚
    <br />
    åŸ·è¡Œãƒ¢ãƒ¼ãƒ‰ï¼šãƒãƒ³ãƒªãƒ¼ã‚µãƒ«ãƒ»ãƒ‘ãƒ©ãƒ©ã‚¤ã‚¶ãƒ¼ã€‚
    <br />
    æ…é‡ã«ç…§æº–ã‚’å®šã‚ å¯¾è±¡ã‚’åˆ¶åœ§ã—ã¦ä¸‹ã•ã„ã€‚
  </Alert>

  <Alert status='warning'>
    <AlertIcon />
    çŠ¯ç½ªä¿‚æ•°ã‚ªãƒ¼ãƒãƒ¼390ã€‚
    <br />
    åŸ·è¡Œãƒ¢ãƒ¼ãƒ‰ï¼šãƒªãƒ¼ã‚µãƒ«ãƒ»ã‚¨ãƒªãƒŸãƒãƒ¼ã‚¿ãƒ¼ã€‚
    <br />
    æ…é‡ã«ç…§æº–ã‚’å®šã‚ã€å¯¾è±¡ã‚’æ’é™¤ã—ã¦ãã ã•ã„ã€‚
  </Alert>

  <Alert status='error'>
    <AlertIcon />
    å¯¾è±¡ã®é©šç•°åˆ¤å®šãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚
    <br />
    åŸ·è¡Œãƒ¢ãƒ¼ãƒ‰ï¼šãƒ‡ã‚¹ãƒˆãƒ­ã‚¤ãƒ»ãƒ‡ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ¼ã€‚
    <br />
    å¯¾è±¡ã‚’å®Œå…¨æ’é™¤ã—ã¾ã™ã€‚ã”æ³¨æ„ä¸‹ã•ã„ã€‚
  </Alert>
</Stack>
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  demoã¨ã¤ã‘ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ä¸Šã«æ›¸ã„ãŸjsxã®ãƒ‡ãƒ¢è¡¨ç¤ºãŒã§ãã¾ã™ï¼
</Callout>

### JSX ã®ãƒ©ã‚¤ãƒ–ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼

`.mdx`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã‚“ãªæ„Ÿã˜ã«æ›¸ãã¨ã€

<CodeBlock>
  {`
\`\`\`jsx live  
<div style={{color: 'red'}}>  
  macho  
</div>  
\`\`\`
`}
</CodeBlock>

ã“ã†ã‚„ã£ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼

```jsx live
<div style={{ color: 'red' }}>macho</div>
```

<Callout emoji='ğŸ™Œ' bg='orange.50'>
  liveã‚’æŒ‡å®šã™ã‚‹ã¨ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’ç·¨é›†ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ã‚„ã£ã¦ã¿ã¦ãã ã•ã„ï¼ï¼
</Callout>

![Live code](./live-code.gif)

ã¾ãŸã€`isManual`ã‚’æŒ‡å®šã™ã‚‹ã¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®šç¾©ã—ã¦è‡ªèº«ã§ render ã™ã‚‹ãƒ©ã‚¤ãƒ–ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãŒæ›¸ã‘ã¾ã™ï¼

```jsx live isManual
function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>You clicked {count} times</p>
      <button
        onClick={() => setCount(count + 1)}
        style={{
          border: '1px solid black',
          padding: '1px 6px',
        }}
      >
        Click me
      </button>
    </div>
  );
}

render(Counter, document.getElementById('root'));
```

## ã‚³ãƒ¼ãƒ‰

ä¸Šã§ç´¹ä»‹ã—ãŸã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ã‚³ãƒ¼ãƒ‰ã§ã™ï¼  
ã”å‚è€ƒã«ï¼ï¼

```text title=ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é–¢é€£ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
src/components/MDXComponents/CodeBlock
  â”œâ”€â”€ CopyButton.js
  â”œâ”€â”€ EditableHighlight.js
  â”œâ”€â”€ Highlight.js
  â”œâ”€â”€ Title.js
  â”œâ”€â”€ index.js
  â””â”€â”€ react-live.js
```

<Collapse>
<>index.js</>

```jsx
import React, { useState } from 'react';

import EditableHighlight from './EditableHighlight';
import Highlight from './Highlight';
import { LiveError, LivePreview, LiveProvider } from './react-live';

const CodeBlock = ({
  className,
  live,
  isManual,
  demo,
  title,
  line,
  children,
  ...props
}) => {
  const [code, setCode] = useState(children.trim());

  const language = className && className.replace('language-', '');

  if (language === 'jsx' && live) {
    return (
      <LiveProvider
        language={language}
        code={code}
        isManual={isManual}
        {...props}
      >
        <LivePreview />
        <EditableHighlight code={code} setCode={setCode} title={title} />
        <LiveError />
      </LiveProvider>
    );
  }

  if (demo) {
    return (
      <LiveProvider
        language={language}
        code={code}
        isManual={isManual}
        {...props}
      >
        <LivePreview />
        <Highlight title={title} code={code} language={language} line={line} />
      </LiveProvider>
    );
  }

  return (
    <Highlight title={title} code={code} language={language} line={line} />
  );
};

export default CodeBlock;
```

</Collapse>

<Collapse>
<>Highlight.js</>

```jsx
import React, { useState } from 'react';
import PrismHighlight, { defaultProps } from 'prism-react-renderer';
import { useTheme, Box } from '@chakra-ui/core';
import theme from 'prism-react-renderer/themes/vsDark';
import rangeParser from 'parse-numeric-range';

import { generateAlphaColors } from '../../../theme/colors-utils';

import CopyButton from './CopyButton';
import Title from './Title';

const highlightStyle = {
  backgroundColor: '#2D2D2D',
  fontFamily: 'Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace',
  fontSize: [12, 14],
  overflow: 'auto',
  py: 5,
  float: 'left',
  minWidth: 'full',
};

const calculateLinesToHighlight = meta => {
  const RE = /{([\d,-]+)}/;
  if (RE.test(meta)) {
    const strLineNumbers = RE.exec(meta)[1];
    const lineNumbers = rangeParser(strLineNumbers);
    return index => lineNumbers.includes(index + 1);
  } else {
    return () => false;
  }
};

const Line = ({ shouldHighlight, children, ...props }) => {
  const highlightProps = shouldHighlight && {
    d: 'block',
    bg: 'gray.700',
    borderLeftWidth: '.5rem',
    borderLeftColor: 'purple.200',
    px: '3',
  };
  return (
    <Box d='table-cell' px='5' {...props} {...highlightProps}>
      {children}
    </Box>
  );
};

const Word = ({ focusedWord, setFocusedWord, content, tokenProps }) => {
  const [delayHandler, setDelayHandler] = useState(null);
  const { colors } = useTheme();

  const orangeAlpha = generateAlphaColors(colors.orange[100]);

  const handleMouseEnter = word => {
    setDelayHandler(
      setTimeout(() => {
        setFocusedWord(word);
      }, 500)
    );
  };

  const handleMouseLeave = () => {
    setFocusedWord('');
    clearTimeout(delayHandler);
  };

  const shouldHighlighted = word => focusedWord === word && word.length > 1;

  return (
    <Box
      as='span'
      bg={shouldHighlighted(content) && orangeAlpha[400]}
      onMouseEnter={() => handleMouseEnter(content)}
      onMouseLeave={handleMouseLeave}
      {...tokenProps}
    />
  );
};

const Highlight = ({ title, code, language, line }) => {
  const [focusedWord, setFocusedWord] = useState('');

  const shouldHighlightLine = calculateLinesToHighlight(line);

  return (
    <Box my='8' rounded='md'>
      {title && <Title>{title}</Title>}
      <Box position='relative'>
        <PrismHighlight
          {...defaultProps}
          theme={theme}
          code={code}
          language={language}
        >
          {({ className, style, tokens, getLineProps, getTokenProps }) => (
            <Box overflowX='auto'>
              <Box
                as='pre'
                className={className}
                {...highlightStyle}
                style={{ ...style }}
              >
                {tokens.map((line, i) => (
                  <div key={i} {...getLineProps({ line, key: i })}>
                    <Line shouldHighlight={shouldHighlightLine(i)}>
                      {line.map((token, key) => (
                        <Word
                          key={key}
                          focusedWord={focusedWord}
                          setFocusedWord={setFocusedWord}
                          content={token.content.trim()}
                          tokenProps={getTokenProps({ token, key })}
                        />
                      ))}
                    </Line>
                  </div>
                ))}
              </Box>
            </Box>
          )}
        </PrismHighlight>
        <CopyButton code={code} />
      </Box>
    </Box>
  );
};

export default Highlight;
```

</Collapse>

<Collapse>
<>EditableHighlight.js</>

```jsx
import React from 'react';
import { LiveEditor } from 'react-live';
import { Box } from '@chakra-ui/core';

import CopyButton from './CopyButton';
import Title from './Title';

const liveEditorStyle = {
  fontSize: 14,
  fontFamily: 'Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace',
  overflow: 'auto',
  backgroundColor: '#2D2D2D',
  whiteSpace: 'nowrap',
};

const EditableNotice = props => (
  <Box
    position='absolute'
    width='full'
    top='.25em'
    letterSpacing='wide'
    color='gray.500'
    fontSize='xs'
    fontWeight='bold'
    textAlign='center'
    textTransform='uppercase'
    {...props}
  >
    Editable Example
  </Box>
);

const EditableHighlight = ({ code, setCode, title }) => {
  const handleCodeChange = newCode => setCode(newCode.trim());

  return (
    <Box my='8' rounded='md'>
      {title && <Title>{title}</Title>}
      <Box position='relative'>
        <LiveEditor
          onChange={handleCodeChange}
          padding={20}
          style={liveEditorStyle}
        />
        <CopyButton code={code} />
        <EditableNotice />
      </Box>
    </Box>
  );
};

export default EditableHighlight;
```

</Collapse>

<Collapse>
<>react-live.js</>

```jsx
import React, { useState } from 'react';
import { mdx } from '@mdx-js/react';
import {
  LiveProvider as ReactLiveProvider,
  LiveError as ReactLiveError,
  LivePreview as ReactLivePreview,
} from 'react-live';
import * as Chakra from '@chakra-ui/core';
import theme from 'prism-react-renderer/themes/vsDark';

import * as widgetComponents from '../../widgetComponents';

const { Box } = Chakra;

const LiveError = props => (
  <Box
    as={ReactLiveError}
    fontFamily='Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace'
    overFlowX='auto'
    color='white'
    bg='red.500'
    {...props}
  />
);

const LivePreview = props => (
  <Box
    as={ReactLivePreview}
    fontFamily='body'
    mt='5'
    p='3'
    border='1px'
    borderColor='inherit'
    rounded='md'
    {...props}
  />
);

const LiveProvider = ({ language, code, isManual, ...props }) => (
  <ReactLiveProvider
    theme={theme}
    language={language}
    code={code}
    transformCode={code => `/** @jsx mdx */ ${code}`}
    scope={{
      ...Chakra,
      ...widgetComponents,
      mdx,
      useState,
    }}
    noInline={isManual}
    {...props}
  />
);

export { LiveError, LivePreview, LiveProvider };
```

</Collapse>

<Collapse>
<>Title.js</>

```jsx
import React from 'react';
import { Box } from '@chakra-ui/core';

const Title = ({ children, ...props }) => (
  <Box
    fontFamily='Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace'
    fontSize='sm'
    py='1'
    px='4'
    color='white'
    bg='#444444'
    overflowX='auto'
    {...props}
  >
    {children}
  </Box>
);

export default Title;
```

</Collapse>

<Collapse>
<>CopyButton.js</>

```jsx
import React from 'react';
import { useClipboard, Button as ChakraButton, Icon } from '@chakra-ui/core';
import { RiFileCopyLine } from 'react-icons/ri';

const Button = ({ hasCopied, ...props }) => (
  <ChakraButton
    size='sm'
    position='absolute'
    textTransform='uppercase'
    variantColor='teal'
    fontSize='xs'
    height='4'
    top='0'
    zIndex='1'
    right='.5em'
    {...props}
  >
    {hasCopied ? 'copied(^âˆ€^)á•—' : <Icon as={RiFileCopyLine} />}
  </ChakraButton>
);

const CopyButton = ({ code, ...props }) => {
  const { onCopy, hasCopied } = useClipboard(code);
  return <Button onClick={onCopy} hasCopied={hasCopied} {...props} />;
};

export default CopyButton;
```

</Collapse>

<ExternalLink href='https://github.com/YuukiOkamoto/my-blog/tree/master/src/components/MDXComponents/CodeBlock'>
  GitHub
</ExternalLink>
